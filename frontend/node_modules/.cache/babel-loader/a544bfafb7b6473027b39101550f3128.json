{"ast":null,"code":"import \"core-js/modules/web.dom-exception.stack.js\";\nimport CustomProgressBar from \"@/components/Items/CustomProgressBar\";\nimport Big from \"big.js\";\nconst BOATLOAD_OF_GAS = Big(3).times(10 ** 13).toFixed();\nexport default {\n  name: \"SingleMeetingComponent\",\n  components: {\n    CustomProgressBar\n  },\n\n  data() {\n    return {\n      currentMeeting: {},\n      currentDonationTypeClassName: '',\n      currentDonationTypeIconName: ''\n    };\n  },\n\n  methods: {\n    async getCurrentMeeting() {\n      const argsBase64 = window.btoa(JSON.stringify({\n        id: +this.$route.params.id\n      }));\n      let result = await window.provider.query({\n        request_type: \"call_function\",\n        account_id: window.walletSelector.getContractId(),\n        method_name: \"get_meeting_by_id\",\n        args_base64: argsBase64,\n        finality: \"optimistic\"\n      }).catch(() => {\n        this.$router.push({\n          'name': 'home'\n        });\n      });\n      this.currentMeeting = JSON.parse(Buffer.from(result.result).toString());\n    },\n\n    async buyTicket() {\n      await window.walletSelector.signAndSendTransaction({\n        signerId: window.nearAccount.accountId,\n        // receiverId: nearConfig.contractName,\n        actions: [{\n          type: \"FunctionCall\",\n          params: {\n            methodName: \"buy_ticket\",\n            args: {\n              \"meeting_id\": +this.$route.params.id\n            },\n            gas: BOATLOAD_OF_GAS,\n            deposit: Big((this.currentMeeting.ticket_price / 10 ** 24).toFixed(5)).times(10 ** 24).toFixed()\n          }\n        }]\n      });\n    },\n\n    async buyTicketAction() {\n      let loader = this.$loading.show();\n\n      try {\n        await this.buyTicket();\n        this.$swal.fire({\n          icon: 'success',\n          title: 'Success',\n          text: 'Ticket was successfully bought!',\n          footer: `To look at your ticket go to your wallet collectibles!`\n        });\n        await this.getCurrentMeeting();\n      } catch (error) {\n        this.$swal.fire({\n          icon: 'error',\n          title: 'Error',\n          text: error.message,\n          footer: ``\n        });\n        console.log(error);\n      }\n\n      loader.hide();\n    }\n\n  },\n\n  async mounted() {\n    let loader = this.$loading.show();\n    await this.getCurrentMeeting();\n    this.currentDonationTypeClassName = this.$DONATION_TYPES[this.currentMeeting.donation_type].className;\n    this.currentDonationTypeIconName = this.$DONATION_TYPES[this.currentMeeting.donation_type].iconName;\n    loader.hide();\n    let uri = window.location.search.substring(1);\n    let params = new URLSearchParams(uri);\n    const transactionHash = params.get('transactionHashes');\n\n    if (transactionHash) {\n      this.$swal.fire({\n        icon: 'success',\n        title: 'Success',\n        text: 'Ticket was successfully bought!',\n        footer: `To look at your ticket go to your wallet collectibles!`\n      });\n    }\n  }\n\n};","map":{"version":3,"mappings":"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","names":["CustomProgressBar","Big","BOATLOAD_OF_GAS","times","toFixed","name","components","data","currentMeeting","currentDonationTypeClassName","currentDonationTypeIconName","methods","getCurrentMeeting","argsBase64","window","btoa","JSON","stringify","id","$route","params","result","provider","query","request_type","account_id","walletSelector","getContractId","method_name","args_base64","finality","catch","$router","push","parse","Buffer","from","toString","buyTicket","signAndSendTransaction","signerId","nearAccount","accountId","actions","type","methodName","args","gas","deposit","ticket_price","buyTicketAction","loader","$loading","show","$swal","fire","icon","title","text","footer","error","message","console","log","hide","mounted","$DONATION_TYPES","donation_type","className","iconName","uri","location","search","substring","URLSearchParams","transactionHash","get"],"sourceRoot":"","sources":["/var/www/ch-8-car-renting/frontend/src/components/Pages/SingleMeetingComponent.vue"],"sourcesContent":["<template>\n  <div class=\"site-section\">\n    <div class=\"container\">\n\n      <div class=\"row mb-5 align-items-st\">\n        <div class=\"col-md-5\">\n          <div class=\"heading-20219\">\n            <h2 class=\"title text-cursive mb-4\">{{ currentMeeting.title }}</h2>\n            <p>{{currentMeeting.description}}</p>\n            <p><button class=\"btn btn-primary rounded-0 px-4\" @click.prevent=\"buyTicketAction\" :disabled=\"currentMeeting.bought_tickets == currentMeeting.total_tickets\">Buy Ticket</button></p>\n          </div>\n        </div>\n        <div class=\"col-md-7\">\n          <div class=\"cause shadow-sm\">\n\n            <a class=\"cause-link d-block\">\n              <img :src=\"currentMeeting.nft_media\" alt=\"Image\" class=\"img-fluid\">\n              <custom-progress-bar :current-value=\"currentMeeting.bought_tickets\" :max-value=\"currentMeeting.total_tickets\"></custom-progress-bar>\n            </a>\n\n            <div class=\"px-3 pt-3 border-top-0 border border shadow-sm\">\n              <span class=\"py-1 small px-2 rounded mb-3 d-inline-block\" :class=\"currentDonationTypeClassName\">\n                <font-awesome-icon :icon=\"currentDonationTypeIconName\" /> {{ currentMeeting.donation_type }}</span>\n              <h3 class=\"mb-4\">{{ currentMeeting.title }}</h3>\n              <div class=\"border-top border-light border-bottom py-2 d-flex justify-content-between\">\n                <div>Ticket price</div>\n                <div class=\"ml-auto\"><strong class=\"text-success\">{{ $filters.formatTicketPrice(currentMeeting.ticket_price) }} â“ƒ</strong></div>\n              </div>\n\n              <div class=\"py-4\">\n                <div class=\"d-flex align-items-center\">\n                  <div class=\"\">{{ currentMeeting.owner_name }}</div>\n                </div>\n              </div>\n            </div>\n\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n\n</template>\n\n<script>\nimport CustomProgressBar from \"@/components/Items/CustomProgressBar\";\nimport Big from \"big.js\";\nconst BOATLOAD_OF_GAS = Big(3).times(10 ** 13).toFixed();\n\nexport default {\n  name: \"SingleMeetingComponent\",\n  components: {\n    CustomProgressBar,\n  },\n  data(){\n    return {\n      currentMeeting:{},\n      currentDonationTypeClassName:'',\n      currentDonationTypeIconName:'',\n    }\n  },\n  methods:{\n    async getCurrentMeeting(){\n      const argsBase64 = window.btoa(JSON.stringify({id:+this.$route.params.id}))\n      let result = await window.provider.query({\n        request_type: \"call_function\",\n        account_id: window.walletSelector.getContractId(),\n        method_name: \"get_meeting_by_id\",\n        args_base64: argsBase64,\n        finality: \"optimistic\",\n      }).catch(()=>{\n        this.$router.push({'name':'home'});\n      })\n      this.currentMeeting = JSON.parse(Buffer.from(result.result).toString())\n    },\n\n    async buyTicket() {\n      await window.walletSelector.signAndSendTransaction({\n        signerId: window.nearAccount.accountId,\n        // receiverId: nearConfig.contractName,\n        actions:[\n          {\n            type: \"FunctionCall\",\n            params: {\n              methodName: \"buy_ticket\",\n              args: {\n                \"meeting_id\": +this.$route.params.id,\n              },\n              gas: BOATLOAD_OF_GAS,\n              deposit: Big((this.currentMeeting.ticket_price / (10**24)).toFixed(5)).times(10 ** 24).toFixed()\n            },\n          },\n        ]\n      });\n    },\n\n    async buyTicketAction(){\n      let loader = this.$loading.show();\n      try {\n        await this.buyTicket();\n        this.$swal.fire({\n          icon: 'success',\n          title: 'Success',\n          text: 'Ticket was successfully bought!',\n          footer: `To look at your ticket go to your wallet collectibles!`,\n        })\n        await this.getCurrentMeeting();\n      }catch (error){\n        this.$swal.fire({\n          icon: 'error',\n          title: 'Error',\n          text: error.message,\n          footer: ``,\n        })\n        console.log(error)\n      }\n      loader.hide();\n\n    }\n  },\n  async mounted() {\n    let loader = this.$loading.show();\n    await this.getCurrentMeeting();\n    this.currentDonationTypeClassName =this.$DONATION_TYPES[this.currentMeeting.donation_type].className;\n    this.currentDonationTypeIconName =  this.$DONATION_TYPES[this.currentMeeting.donation_type].iconName;\n    loader.hide();\n\n    let uri = window.location.search.substring(1);\n    let params = new URLSearchParams(uri);\n    const transactionHash = params.get('transactionHashes');\n    if(transactionHash){\n      this.$swal.fire({\n        icon: 'success',\n        title: 'Success',\n        text: 'Ticket was successfully bought!',\n        footer: `To look at your ticket go to your wallet collectibles!`,\n      })\n    }\n  },\n}\n</script>\n\n<style scoped>\n\n</style>"]},"metadata":{},"sourceType":"module"}