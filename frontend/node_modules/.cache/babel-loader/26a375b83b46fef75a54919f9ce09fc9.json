{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport BufferList from 'bl/BufferList.js';\nimport { create } from 'rabin-wasm';\nimport errcode from 'err-code';\n\nasync function* rabinChunker(source, options) {\n  let min, max, avg;\n\n  if (options.minChunkSize && options.maxChunkSize && options.avgChunkSize) {\n    avg = options.avgChunkSize;\n    min = options.minChunkSize;\n    max = options.maxChunkSize;\n  } else if (!options.avgChunkSize) {\n    throw errcode(new Error('please specify an average chunk size'), 'ERR_INVALID_AVG_CHUNK_SIZE');\n  } else {\n    avg = options.avgChunkSize;\n    min = avg / 3;\n    max = avg + avg / 2;\n  }\n\n  if (min < 16) {\n    throw errcode(new Error('rabin min must be greater than 16'), 'ERR_INVALID_MIN_CHUNK_SIZE');\n  }\n\n  if (max < min) {\n    max = min;\n  }\n\n  if (avg < min) {\n    avg = min;\n  }\n\n  const sizepow = Math.floor(Math.log2(avg));\n\n  for await (const chunk of rabin(source, {\n    min: min,\n    max: max,\n    bits: sizepow,\n    window: options.window,\n    polynomial: options.polynomial\n  })) {\n    yield chunk;\n  }\n}\n\nexport default rabinChunker;\n\nasync function* rabin(source, options) {\n  const r = await create(options.bits, options.min, options.max, options.window);\n  const buffers = new BufferList();\n\n  for await (const chunk of source) {\n    buffers.append(chunk);\n    const sizes = r.fingerprint(chunk);\n\n    for (let i = 0; i < sizes.length; i++) {\n      const size = sizes[i];\n      const buf = buffers.slice(0, size);\n      buffers.consume(size);\n      yield buf;\n    }\n  }\n\n  if (buffers.length) {\n    yield buffers.slice(0);\n  }\n}","map":{"version":3,"names":["BufferList","create","errcode","rabinChunker","source","options","min","max","avg","minChunkSize","maxChunkSize","avgChunkSize","Error","sizepow","Math","floor","log2","chunk","rabin","bits","window","polynomial","r","buffers","append","sizes","fingerprint","i","length","size","buf","slice","consume"],"sources":["/var/www/ch-8-car-renting/frontend/node_modules/ipfs-unixfs-importer/esm/src/chunker/rabin.js"],"sourcesContent":["import BufferList from 'bl/BufferList.js';\nimport { create } from 'rabin-wasm';\nimport errcode from 'err-code';\nasync function* rabinChunker(source, options) {\n  let min, max, avg;\n  if (options.minChunkSize && options.maxChunkSize && options.avgChunkSize) {\n    avg = options.avgChunkSize;\n    min = options.minChunkSize;\n    max = options.maxChunkSize;\n  } else if (!options.avgChunkSize) {\n    throw errcode(new Error('please specify an average chunk size'), 'ERR_INVALID_AVG_CHUNK_SIZE');\n  } else {\n    avg = options.avgChunkSize;\n    min = avg / 3;\n    max = avg + avg / 2;\n  }\n  if (min < 16) {\n    throw errcode(new Error('rabin min must be greater than 16'), 'ERR_INVALID_MIN_CHUNK_SIZE');\n  }\n  if (max < min) {\n    max = min;\n  }\n  if (avg < min) {\n    avg = min;\n  }\n  const sizepow = Math.floor(Math.log2(avg));\n  for await (const chunk of rabin(source, {\n      min: min,\n      max: max,\n      bits: sizepow,\n      window: options.window,\n      polynomial: options.polynomial\n    })) {\n    yield chunk;\n  }\n}\nexport default rabinChunker;\nasync function* rabin(source, options) {\n  const r = await create(options.bits, options.min, options.max, options.window);\n  const buffers = new BufferList();\n  for await (const chunk of source) {\n    buffers.append(chunk);\n    const sizes = r.fingerprint(chunk);\n    for (let i = 0; i < sizes.length; i++) {\n      const size = sizes[i];\n      const buf = buffers.slice(0, size);\n      buffers.consume(size);\n      yield buf;\n    }\n  }\n  if (buffers.length) {\n    yield buffers.slice(0);\n  }\n}"],"mappings":";AAAA,OAAOA,UAAP,MAAuB,kBAAvB;AACA,SAASC,MAAT,QAAuB,YAAvB;AACA,OAAOC,OAAP,MAAoB,UAApB;;AACA,gBAAgBC,YAAhB,CAA6BC,MAA7B,EAAqCC,OAArC,EAA8C;EAC5C,IAAIC,GAAJ,EAASC,GAAT,EAAcC,GAAd;;EACA,IAAIH,OAAO,CAACI,YAAR,IAAwBJ,OAAO,CAACK,YAAhC,IAAgDL,OAAO,CAACM,YAA5D,EAA0E;IACxEH,GAAG,GAAGH,OAAO,CAACM,YAAd;IACAL,GAAG,GAAGD,OAAO,CAACI,YAAd;IACAF,GAAG,GAAGF,OAAO,CAACK,YAAd;EACD,CAJD,MAIO,IAAI,CAACL,OAAO,CAACM,YAAb,EAA2B;IAChC,MAAMT,OAAO,CAAC,IAAIU,KAAJ,CAAU,sCAAV,CAAD,EAAoD,4BAApD,CAAb;EACD,CAFM,MAEA;IACLJ,GAAG,GAAGH,OAAO,CAACM,YAAd;IACAL,GAAG,GAAGE,GAAG,GAAG,CAAZ;IACAD,GAAG,GAAGC,GAAG,GAAGA,GAAG,GAAG,CAAlB;EACD;;EACD,IAAIF,GAAG,GAAG,EAAV,EAAc;IACZ,MAAMJ,OAAO,CAAC,IAAIU,KAAJ,CAAU,mCAAV,CAAD,EAAiD,4BAAjD,CAAb;EACD;;EACD,IAAIL,GAAG,GAAGD,GAAV,EAAe;IACbC,GAAG,GAAGD,GAAN;EACD;;EACD,IAAIE,GAAG,GAAGF,GAAV,EAAe;IACbE,GAAG,GAAGF,GAAN;EACD;;EACD,MAAMO,OAAO,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,IAAL,CAAUR,GAAV,CAAX,CAAhB;;EACA,WAAW,MAAMS,KAAjB,IAA0BC,KAAK,CAACd,MAAD,EAAS;IACpCE,GAAG,EAAEA,GAD+B;IAEpCC,GAAG,EAAEA,GAF+B;IAGpCY,IAAI,EAAEN,OAH8B;IAIpCO,MAAM,EAAEf,OAAO,CAACe,MAJoB;IAKpCC,UAAU,EAAEhB,OAAO,CAACgB;EALgB,CAAT,CAA/B,EAMM;IACJ,MAAMJ,KAAN;EACD;AACF;;AACD,eAAed,YAAf;;AACA,gBAAgBe,KAAhB,CAAsBd,MAAtB,EAA8BC,OAA9B,EAAuC;EACrC,MAAMiB,CAAC,GAAG,MAAMrB,MAAM,CAACI,OAAO,CAACc,IAAT,EAAed,OAAO,CAACC,GAAvB,EAA4BD,OAAO,CAACE,GAApC,EAAyCF,OAAO,CAACe,MAAjD,CAAtB;EACA,MAAMG,OAAO,GAAG,IAAIvB,UAAJ,EAAhB;;EACA,WAAW,MAAMiB,KAAjB,IAA0Bb,MAA1B,EAAkC;IAChCmB,OAAO,CAACC,MAAR,CAAeP,KAAf;IACA,MAAMQ,KAAK,GAAGH,CAAC,CAACI,WAAF,CAAcT,KAAd,CAAd;;IACA,KAAK,IAAIU,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,KAAK,CAACG,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;MACrC,MAAME,IAAI,GAAGJ,KAAK,CAACE,CAAD,CAAlB;MACA,MAAMG,GAAG,GAAGP,OAAO,CAACQ,KAAR,CAAc,CAAd,EAAiBF,IAAjB,CAAZ;MACAN,OAAO,CAACS,OAAR,CAAgBH,IAAhB;MACA,MAAMC,GAAN;IACD;EACF;;EACD,IAAIP,OAAO,CAACK,MAAZ,EAAoB;IAClB,MAAML,OAAO,CAACQ,KAAR,CAAc,CAAd,CAAN;EACD;AACF"},"metadata":{},"sourceType":"module"}