{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, withModifiers as _withModifiers, createStaticVNode as _createStaticVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"site-section p-4\"\n};\nconst _hoisted_2 = {\n  class: \"container\"\n};\n\nconst _hoisted_3 = /*#__PURE__*/_createStaticVNode(\"<div class=\\\"p-4 p-md-5 mb-4 text-white rounded bg-dark\\\"><div class=\\\"col-6 px-0\\\"><h1 class=\\\"display-4 fst-italic\\\">Title of a longer featured blog post</h1><p class=\\\"lead my-3\\\">Multiple lines of text that form the lede, informing new readers quickly and efficiently about what’s most interesting in this post’s contents.</p><p class=\\\"lead mb-0\\\"><a href=\\\"#\\\" class=\\\"text-white fw-bold\\\">Continue reading...</a></p></div></div>\", 1);\n\nconst _hoisted_4 = {\n  class: \"row mb-5 align-items-st\"\n};\nconst _hoisted_5 = {\n  class: \"col-md-5\"\n};\nconst _hoisted_6 = {\n  class: \"heading-20219\"\n};\nconst _hoisted_7 = {\n  class: \"title text-cursive mb-4\"\n};\nconst _hoisted_8 = [\"disabled\"];\nconst _hoisted_9 = {\n  class: \"col-md-7\"\n};\nconst _hoisted_10 = {\n  class: \"cause shadow-sm\"\n};\nconst _hoisted_11 = {\n  class: \"cause-link d-block\"\n};\nconst _hoisted_12 = [\"src\"];\nconst _hoisted_13 = {\n  class: \"px-3 pt-3 border-top-0 border border shadow-sm\"\n};\nconst _hoisted_14 = {\n  class: \"mb-4\"\n};\nconst _hoisted_15 = {\n  class: \"border-top border-light border-bottom py-2 d-flex justify-content-between\"\n};\n\nconst _hoisted_16 = /*#__PURE__*/_createElementVNode(\"div\", null, \"Ticket price\", -1\n/* HOISTED */\n);\n\nconst _hoisted_17 = {\n  class: \"ml-auto\"\n};\nconst _hoisted_18 = {\n  class: \"text-success\"\n};\nconst _hoisted_19 = {\n  class: \"py-4\"\n};\nconst _hoisted_20 = {\n  class: \"d-flex align-items-center\"\n};\nconst _hoisted_21 = {\n  class: \"\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"h2\", _hoisted_7, _toDisplayString($data.currentCar.title), 1\n  /* TEXT */\n  ), _createElementVNode(\"p\", null, _toDisplayString($data.currentCar.description), 1\n  /* TEXT */\n  ), _createElementVNode(\"p\", null, [_createElementVNode(\"button\", {\n    class: \"btn btn-primary rounded-0 px-4\",\n    onClick: _cache[0] || (_cache[0] = _withModifiers((...args) => $options.buyTicketAction && $options.buyTicketAction(...args), [\"prevent\"])),\n    disabled: $data.currentCar.is_rented\n  }, \"Rent car\", 8\n  /* PROPS */\n  , _hoisted_8)])])]), _createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"a\", _hoisted_11, [_createElementVNode(\"img\", {\n    src: $data.currentCar.image,\n    alt: \"Image\",\n    class: \"img-fluid\"\n  }, null, 8\n  /* PROPS */\n  , _hoisted_12)]), _createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"h3\", _hoisted_14, _toDisplayString($data.currentCar.title), 1\n  /* TEXT */\n  ), _createElementVNode(\"div\", _hoisted_15, [_hoisted_16, _createElementVNode(\"div\", _hoisted_17, [_createElementVNode(\"strong\", _hoisted_18, _toDisplayString(_ctx.$filters.formatYoctoNearToNear($data.currentCar.price_per_hour)) + \" Ⓝ\", 1\n  /* TEXT */\n  )])]), _createElementVNode(\"div\", _hoisted_19, [_createElementVNode(\"div\", _hoisted_20, [_createElementVNode(\"div\", _hoisted_21, _toDisplayString($data.currentCar.owner_id), 1\n  /* TEXT */\n  )])])])])])])])]);\n}","map":{"version":3,"mappings":";;EACOA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;;;;EASJA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;EACLA,KAAK,EAAC;;;;EAKTA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;EAENA,KAAK,EAAC;;;;EAIJA,KAAK,EAAC;;;EACLA,KAAK,EAAC;;;EACLA,KAAK,EAAC;;;iCACTC,oBAAuB,KAAvB,EAAuB,IAAvB,EAAK,cAAL,EAAiB;AAAA;AAAjB;;;EACKD,KAAK,EAAC;;;EAAkBA,KAAK,EAAC;;;EAGhCA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;uBAlC3BE,oBA2CM,KA3CN,cA2CM,CA1CJD,oBAyCM,KAzCN,cAyCM,CAxCJE,UAwCI,EAhCJF,oBA+BM,KA/BN,cA+BM,CA9BJA,oBAMM,KANN,cAMM,CALJA,oBAIM,KAJN,cAIM,CAHJA,oBAA+D,IAA/D,cAA+DG,iBAAxBC,iBAAWC,KAAa,CAA/D,EAAuD;EAAA;EAAvD,CAGI,EAFJL,oBAAiC,GAAjC,EAAiC,IAAjC,EAAiCG,iBAA5BC,iBAAWE,WAAiB,CAAjC,EAA2B;EAAA;EAA3B,CAEI,EADJN,oBAAyI,GAAzI,EAAyI,IAAzI,EAAyI,CAAtIA,oBAAkI,QAAlI,EAAkI;IAA1HD,KAAK,EAAC,gCAAoH;IAAlFQ,OAAK,wDAAUC,6DAAV,EAAyB,WAAzB,EAA6E;IAAjDC,QAAQ,EAAEL,iBAAWM;EAA4B,CAAlI,EAAiH,UAAjH,EAAyH;EAAA;EAAzH,EAAyHC,UAAzH,CAAsI,CAAzI,CACI,CAJN,CAKI,CANN,CA8BI,EAvBJX,oBAsBM,KAtBN,cAsBM,CArBJA,oBAoBM,KApBN,eAoBM,CAlBJA,oBAEI,GAFJ,eAEI,CADFA,oBAA2D,KAA3D,EAA2D;IAArDY,GAAG,EAAER,iBAAWS,KAAqC;IAA9BC,GAAG,EAAC,OAA0B;IAAlBf,KAAK,EAAC;EAAY,CAA3D;;EAAA,cACE,CAFJ,CAkBI,EAdJC,oBAYM,KAZN,eAYM,CAXJA,oBAA4C,IAA5C,eAA4CG,iBAAxBC,iBAAWC,KAAa,CAA5C,EAAoC;EAAA;EAApC,CAWI,EAVJL,oBAGM,KAHN,eAGM,CAFJe,WAEI,EADJf,oBAAkI,KAAlI,eAAkI,CAA7GA,oBAAuG,QAAvG,eAAuGG,iBAAvEa,cAASC,qBAAT,CAA+Bb,iBAAWc,cAA1C,CAAuE,IAAX,IAA5F,EAA8F;EAAA;EAA9F,CAA6G,CAAlI,CACI,CAHN,CAUI,EALJlB,oBAIM,KAJN,eAIM,CAHJA,oBAEM,KAFN,eAEM,CADJA,oBAA6C,KAA7C,eAA6CG,iBAA5BC,iBAAWe,QAAiB,CAA7C,EAAoC;EAAA;EAApC,CACI,CAFN,CAGI,CAJN,CAKI,CAZN,CAcI,CApBN,CAqBI,CAtBN,CAuBI,CA/BN,CAgCI,CAzCN,CA0CI,CA3CN","names":["class","_createElementVNode","_createElementBlock","_hoisted_3","_toDisplayString","$data","title","description","onClick","$options","disabled","is_rented","_hoisted_8","src","image","alt","_hoisted_16","_ctx","formatYoctoNearToNear","price_per_hour","owner_id"],"sourceRoot":"","sources":["/var/www/ch-8-car-renting/frontend/src/components/Pages/SingleCarComponent.vue"],"sourcesContent":["<template>\n  <div class=\"site-section p-4\">\n    <div class=\"container\">\n      <div class=\"p-4 p-md-5 mb-4 text-white rounded bg-dark\">\n        <div class=\"col-6 px-0\">\n          <h1 class=\"display-4 fst-italic\">Title of a longer featured blog post</h1>\n          <p class=\"lead my-3\">Multiple lines of text that form the lede, informing new readers quickly and efficiently about what’s most interesting in this post’s contents.</p>\n          <p class=\"lead mb-0\"><a href=\"#\" class=\"text-white fw-bold\">Continue reading...</a></p>\n        </div>\n      </div>\n\n      <div class=\"row mb-5 align-items-st\">\n        <div class=\"col-md-5\">\n          <div class=\"heading-20219\">\n            <h2 class=\"title text-cursive mb-4\">{{ currentCar.title }}</h2>\n            <p>{{currentCar.description}}</p>\n            <p><button class=\"btn btn-primary rounded-0 px-4\" @click.prevent=\"buyTicketAction\" :disabled=\"currentCar.is_rented\">Rent car</button></p>\n          </div>\n        </div>\n        <div class=\"col-md-7\">\n          <div class=\"cause shadow-sm\">\n\n            <a class=\"cause-link d-block\">\n              <img :src=\"currentCar.image\" alt=\"Image\" class=\"img-fluid\">\n            </a>\n\n            <div class=\"px-3 pt-3 border-top-0 border border shadow-sm\">\n              <h3 class=\"mb-4\">{{ currentCar.title }}</h3>\n              <div class=\"border-top border-light border-bottom py-2 d-flex justify-content-between\">\n                <div>Ticket price</div>\n                <div class=\"ml-auto\"><strong class=\"text-success\">{{ $filters.formatYoctoNearToNear(currentCar.price_per_hour) }} Ⓝ</strong></div>\n              </div>\n\n              <div class=\"py-4\">\n                <div class=\"d-flex align-items-center\">\n                  <div class=\"\">{{ currentCar.owner_id }}</div>\n                </div>\n              </div>\n            </div>\n\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n\n</template>\n\n<script>\nimport Big from \"big.js\";\nimport * as nearAPI from \"near-api-js\";\nconst BOATLOAD_OF_GAS = Big(3).times(10 ** 13).toFixed();\n\nexport default {\n  name: \"SingleCarComponent\",\n  components: {\n  },\n  data(){\n    return {\n      currentCar:{},\n    }\n  },\n  methods:{\n    async getCurrentCar(){\n      const provider = new nearAPI.providers.JsonRpcProvider(window.nearConfig.nodeUrl);\n      const argsBase64 = window.btoa(JSON.stringify({id:+this.$route.params.id}))\n      const rawResult = await provider.query({\n        request_type: \"call_function\",\n        finality: \"final\",\n        account_id: window.nearConfig.contractName,\n        method_name: \"get_car_by_id\",\n        args_base64: argsBase64,\n      }).catch(()=>{\n        this.$router.push({'name':'home'});\n      });\n      this.currentCar = JSON.parse(Buffer.from(rawResult.result).toString())\n    },\n\n    async buyTicket() {\n      await window.walletSelector.signAndSendTransaction({\n        signerId: window.nearAccount.accountId,\n        // receiverId: nearConfig.contractName,\n        actions:[\n          {\n            type: \"FunctionCall\",\n            params: {\n              methodName: \"buy_ticket\",\n              args: {\n                \"meeting_id\": +this.$route.params.id,\n              },\n              gas: BOATLOAD_OF_GAS,\n              deposit: Big((this.currentMeeting.ticket_price / (10**24)).toFixed(5)).times(10 ** 24).toFixed()\n            },\n          },\n        ]\n      });\n    },\n\n    async buyTicketAction(){\n      let loader = this.$loading.show();\n      try {\n        await this.buyTicket();\n        this.$swal.fire({\n          icon: 'success',\n          title: 'Success',\n          text: 'Ticket was successfully bought!',\n          footer: `To look at your ticket go to your wallet collectibles!`,\n        })\n        await this.getCurrentMeeting();\n      }catch (error){\n        this.$swal.fire({\n          icon: 'error',\n          title: 'Error',\n          text: error.message,\n          footer: ``,\n        })\n        console.log(error)\n      }\n      loader.hide();\n\n    }\n  },\n  async mounted() {\n    let loader = this.$loading.show();\n    await this.getCurrentCar();\n    loader.hide();\n    //\n    // let uri = window.location.search.substring(1);\n    // let params = new URLSearchParams(uri);\n    // const transactionHash = params.get('transactionHashes');\n    // if(transactionHash){\n    //   this.$swal.fire({\n    //     icon: 'success',\n    //     title: 'Success',\n    //     text: 'Ticket was successfully bought!',\n    //     footer: `To look at your ticket go to your wallet collectibles!`,\n    //   })\n    // }\n  },\n}\n</script>\n\n<style scoped>\n\n</style>"]},"metadata":{},"sourceType":"module"}