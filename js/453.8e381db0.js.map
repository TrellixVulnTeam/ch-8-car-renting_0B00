{"version":3,"file":"js/453.8e381db0.js","mappings":"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","sources":["webpack://frontend/./helpers.js","webpack://frontend/./src/components/Pages/CarListItemComponent.vue","webpack://frontend/./src/components/Pages/CarListItemComponent.vue?f666","webpack://frontend/./src/components/Pages/CarsComponent.vue","webpack://frontend/./src/components/Pages/CarsComponent.vue?8767"],"sourcesContent":["import {providers} from \"near-api-js\";\n\nfunction getUrlParams(){\n    let uri = window.location.search.substring(1);\n    return new URLSearchParams(uri);\n}\n\nasync function getTransactionState(txHash) {\n    const provider = new providers.JsonRpcProvider(\n        \"https://archival-rpc.testnet.near.org\"\n    );\n    return await provider.txStatus(txHash, window.nearAccount.accountId);\n}\n\nexport {getUrlParams, getTransactionState}","<template>\n  <div class=\"col-4 mb-4\">\n    <div class=\"card\">\n      <img :src=\"image\" class=\"card-img-top\" alt=\"...\" style=\"height: 250px\">\n      <div class=\"card-body\">\n        <h5 class=\"card-title\">{{ title }}</h5>\n        <p class=\"card-text\">{{description}}</p>\n      </div>\n      <ul class=\"list-group list-group-flush\">\n        <li class=\"list-group-item d-flex justify-content-between\"><span>Owner:</span><span>{{owner_id}}</span></li>\n        <li class=\"list-group-item d-flex justify-content-between\"><span>Price per month:</span><span>{{$filters.formatYoctoNearToNear(price_per_month)}} Ⓝ</span></li>\n      </ul>\n      <router-link :to=\"{name:'car-single',params:{id:id}}\" class=\"btn btn-primary\">Go to car page</router-link>\n      <div v-if=\"is_rent\">\n        <hr>\n        <ul class=\"list-group list-group-flush\">\n          <li class=\"list-group-item d-flex justify-content-between\"><span>Already paid:</span><span>{{$filters.formatYoctoNearToNear(alreadyPaid)}} Ⓝ</span></li>\n        </ul>\n        <button class=\"btn btn-danger w-100\" @click.prevent=\"startCancelRentCarProcess\">Cancel renting</button>\n      </div>\n\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport {getTransactionState, getUrlParams} from \"../../../helpers\";\nimport Big from \"big.js\";\n\nexport default {\n  name: \"CarListItemComponent\",\n  props: [\n    'id',\n    'title',\n    'description',\n    'image',\n    'owner_id',\n    'price_per_month',\n    'is_rent',\n    'stream_id',\n    'rent',\n  ],\n  methods:{\n\n    async continueCancelRentCarProcess() {\n      let loader = this.$loading.show();\n      let params = getUrlParams();\n      let transactionHashes = params.get('transactionHashes');\n      if (transactionHashes !== null){\n        let result = await getTransactionState(transactionHashes);\n        if (\"SuccessValue\" in result.status){\n          const transactionMethodName = result.transaction.actions[0].FunctionCall.method_name;\n          switch (transactionMethodName){\n            case 'stop_stream':\n              this.$swal.fire({\n                icon: 'success',\n                title: 'Success',\n                text: 'Car rent was canceled!',\n                footer: ``,\n              })\n              this.cleanGetParams();\n              break;\n\n          }\n        }\n      }\n      loader.hide();\n    },\n    cleanGetParams(){\n      window.history.pushState({}, document.title, process.env.VUE_APP_APP_URL + '#' + this.$route.fullPath);\n    },\n    async startCancelRentCarProcess(){\n      let loader = this.$loading.show();\n      window.walletConnection.account().functionCall({\n        contractId: window.nearConfig.contractName,\n        methodName: 'stop_rent_car',\n        args: {\"car_id\": +this.id},\n        gas:\"200000000000000\",\n      }).then((response)=>{\n        window.walletConnection.account().functionCall({\n          contractId: window.roketoContractName,\n          methodName: 'stop_stream',\n          args: {\"stream_id\": this.stream_id},\n          gas:\"200000000000000\",\n          attachedDeposit:1,\n        }).then((response)=>{\n          console.log(response)\n        });\n      });\n      loader.hide();\n    },\n  },\n  async mounted() {\n    let loader = this.$loading.show();\n    await this.continueCancelRentCarProcess()\n    loader.hide()\n  },\n  computed:{\n    alreadyPaid(){\n      let currentTimestamp = (+ new Date());\n      console.log(currentTimestamp)\n      let rentTimestamp = new Date;\n      rentTimestamp.setTime(this.rent.timestamp_created.toString().substring(0,13));\n      console.log(+rentTimestamp)\n      let secondsLeft = ((currentTimestamp - rentTimestamp) / 1000).toFixed();\n      return secondsLeft * this.rent.tokens_per_sec;\n    }\n  }\n\n}\n</script>\n\n<style scoped>\n\n</style>","import { render } from \"./CarListItemComponent.vue?vue&type=template&id=3bfe1556\"\nimport script from \"./CarListItemComponent.vue?vue&type=script&lang=js\"\nexport * from \"./CarListItemComponent.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/var/www/ch-8-car-renting/frontend/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n  <section class=\"site-section p-4\">\n    <div class=\"container\">\n\n      <div class=\"row\">\n        <car-list-item-component v-for=\"(car,key) in cars\" :key=\"key\"\n                                 :id=\"key\"\n                                 :title=\"car.title\"\n                                 :description=\"car.description\"\n                                 :image=\"car.image\"\n                                 :owner_id=\"car.owner_id\"\n                                 :price_per_month=\"car.price_per_month\"\n        >\n\n        </car-list-item-component>\n\n      </div>\n    </div>\n  </section>\n</template>\n\n<script>\nimport * as nearAPI from 'near-api-js';\nimport CarListItemComponent from \"@/components/Pages/CarListItemComponent\";\nexport default {\n  name: \"CarsComponent\",\n  components:{\n    CarListItemComponent\n  },\n  data(){\n    return {\n      cars : {}\n    }\n  },\n  methods:{\n    async getAllCars(){\n      const provider = new nearAPI.providers.JsonRpcProvider(window.nearConfig.nodeUrl);\n      const rawResult = await provider.query({\n        request_type: \"call_function\",\n        finality: \"final\",\n        account_id: window.nearConfig.contractName,\n        method_name: \"get_all_cars\",\n        args_base64: '',\n      });\n      this.cars = JSON.parse(Buffer.from(rawResult.result).toString())\n    }\n  },\n  async mounted() {\n    let loader = this.$loading.show();\n    await this.getAllCars()\n    loader.hide()\n  },\n}\n</script>\n\n<style scoped>\n\n\n</style>","import { render } from \"./CarsComponent.vue?vue&type=template&id=7754730e\"\nimport script from \"./CarsComponent.vue?vue&type=script&lang=js\"\nexport * from \"./CarsComponent.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/var/www/ch-8-car-renting/frontend/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["getUrlParams","uri","window","location","search","substring","URLSearchParams","async","getTransactionState","txHash","provider","providers","txStatus","nearAccount","accountId","class","_createElementVNode","_createElementBlock","src","$props","alt","style","_toDisplayString","_hoisted_9","_hoisted_11","_ctx","formatYoctoNearToNear","_createVNode","_component_router_link","to","name","params","id","_hoisted_13","_hoisted_14","_hoisted_17","$options","onClick","props","methods","loader","this","$loading","show","transactionHashes","get","result","status","transactionMethodName","transaction","actions","FunctionCall","method_name","$swal","fire","icon","title","text","footer","cleanGetParams","hide","history","pushState","document","process","$route","fullPath","walletConnection","account","functionCall","contractId","nearConfig","contractName","methodName","args","gas","then","response","roketoContractName","stream_id","attachedDeposit","console","log","continueCancelRentCarProcess","computed","alreadyPaid","currentTimestamp","Date","rentTimestamp","setTime","rent","timestamp_created","toString","secondsLeft","toFixed","tokens_per_sec","__exports__","render","_Fragment","_renderList","$data","car","key","_createBlock","_component_car_list_item_component","description","image","owner_id","price_per_month","components","CarListItemComponent","data","cars","nearAPI","nodeUrl","rawResult","query","request_type","finality","account_id","args_base64","JSON","parse","Buffer","from","getAllCars"],"sourceRoot":""}