{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"site-section p-4\"\n};\nconst _hoisted_2 = {\n  class: \"container\"\n};\nconst _hoisted_3 = {\n  class: \"row\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_car_list_item_component = _resolveComponent(\"car-list-item-component\");\n\n  return _openBlock(), _createElementBlock(\"section\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.cars, (car, key) => {\n    return _openBlock(), _createBlock(_component_car_list_item_component, {\n      key: key,\n      id: key,\n      title: car.car.title,\n      description: car.car.description,\n      image: car.car.image,\n      owner_id: car.car.owner_id,\n      price_per_month: car.car.price_per_month,\n      is_rent: \"true\",\n      stream_id: car.rent.id,\n      already_paid: car.rent.balance\n    }, null, 8\n    /* PROPS */\n    , [\"id\", \"title\", \"description\", \"image\", \"owner_id\", \"price_per_month\", \"stream_id\", \"already_paid\"]);\n  }), 128\n  /* KEYED_FRAGMENT */\n  ))])])]);\n}","map":{"version":3,"mappings":";;EACWA,KAAK,EAAC;;;EACRA,KAAK,EAAC;;;EAEJA,KAAK,EAAC;;;;;uBAHfC,oBAoBU,SApBV,cAoBU,CAnBRC,oBAkBM,KAlBN,cAkBM,CAhBJA,oBAeM,KAfN,cAeM,oBAdJD,oBAY0BE,SAZ1B,EAY0B,IAZ1B,EAY0BC,YAZmBC,UAYnB,EAZuB,CAAhBC,GAAgB,EAAZC,GAAY,KAAT;yBAAxCC,aAY0BC,kCAZ1B,EAY0B;MAZ0BF,GAAG,EAAEA,GAY/B;MAXAG,EAAE,EAAEH,GAWJ;MAVAI,KAAK,EAAEL,GAAG,CAACA,GAAJ,CAAQK,KAUf;MATAC,WAAW,EAAEN,GAAG,CAACA,GAAJ,CAAQM,WASrB;MARAC,KAAK,EAAEP,GAAG,CAACA,GAAJ,CAAQO,KAQf;MAPAC,QAAQ,EAAER,GAAG,CAACA,GAAJ,CAAQQ,QAOlB;MANAC,eAAe,EAAET,GAAG,CAACA,GAAJ,CAAQS,eAMzB;MALDC,OAAO,EAAC,MAKP;MAJAC,SAAS,EAAEX,GAAG,CAACY,IAAJ,CAASR,EAIpB;MAHAS,YAAY,EAAEb,GAAG,CAACY,IAAJ,CAASE;IAGvB,CAZ1B;;IAAA;GAY0B,CAZ1B;;EAAA,CAcI,EAfN,CAgBI,CAlBN,CAmBQ,CApBV","names":["class","_createElementBlock","_createElementVNode","_Fragment","_renderList","$data","car","key","_createBlock","_component_car_list_item_component","id","title","description","image","owner_id","price_per_month","is_rent","stream_id","rent","already_paid","balance"],"sourceRoot":"","sources":["/var/www/ch-8-car-renting/frontend/src/components/Pages/MyRentsComponent.vue"],"sourcesContent":["<template>\n  <section class=\"site-section p-4\">\n    <div class=\"container\">\n\n      <div class=\"row\">\n        <car-list-item-component v-for=\"(car,key) in cars\" :key=\"key\"\n                                 :id=\"key\"\n                                 :title=\"car.car.title\"\n                                 :description=\"car.car.description\"\n                                 :image=\"car.car.image\"\n                                 :owner_id=\"car.car.owner_id\"\n                                 :price_per_month=\"car.car.price_per_month\"\n                                 is_rent=\"true\"\n                                 :stream_id=\"car.rent.id\"\n                                 :already_paid=\"car.rent.balance\"\n        >\n\n        </car-list-item-component>\n\n      </div>\n    </div>\n  </section>\n</template>\n\n<script>\nimport CarListItemComponent from \"@/components/Pages/CarListItemComponent\";\nimport * as nearAPI from \"near-api-js\";\nimport {getTransactionState, getUrlParams} from \"../../../helpers\";\nimport Big from \"big.js\";\n\nexport default {\n  name: \"MyRentsComponent\",\n  components:{\n    CarListItemComponent\n  },\n  data(){\n    return {\n      cars : {}\n    }\n  },\n  methods:{\n    async getStream(stream_id){\n      const provider = new nearAPI.providers.JsonRpcProvider(window.nearConfig.nodeUrl);\n      const argsBase64 = window.btoa(JSON.stringify({\"stream_id\":stream_id}))\n      const rawResult = await provider.query({\n        request_type: \"call_function\",\n        finality: \"final\",\n        account_id: window.roketoContractName,\n        method_name: \"get_stream\",\n        args_base64: argsBase64,\n      });\n      return JSON.parse(Buffer.from(rawResult.result).toString())\n    },\n    async getMyCars(){\n      const provider = new nearAPI.providers.JsonRpcProvider(window.nearConfig.nodeUrl);\n      const argsBase64 = window.btoa(JSON.stringify({renter_account_id:window.nearAccount.accountId}))\n      const rawResult = await provider.query({\n        request_type: \"call_function\",\n        finality: \"final\",\n        account_id: window.nearConfig.contractName,\n        method_name: \"get_rents_by_renter_id\",\n        args_base64: argsBase64,\n      });\n      let cars = JSON.parse(Buffer.from(rawResult.result).toString())\n      console.log(cars)\n      let result = [];\n      for (const [key, value] of Object.entries(cars)) {\n        result.push({\n          car:value.car,\n          rent: await this.getStream(value.rent.stream_id)\n        })\n      }\n      this.cars = result;\n      console.log(result)\n    },\n\n\n  },\n  async mounted() {\n    let loader = this.$loading.show();\n    await this.getMyCars()\n    loader.hide()\n  },\n\n}\n</script>\n\n<style scoped>\n\n</style>"]},"metadata":{},"sourceType":"module"}