{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"site-section p-4\"\n};\nconst _hoisted_2 = {\n  class: \"container\"\n};\nconst _hoisted_3 = {\n  class: \"row\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_car_list_item_component = _resolveComponent(\"car-list-item-component\");\n\n  return _openBlock(), _createElementBlock(\"section\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.cars, (car, key) => {\n    return _openBlock(), _createBlock(_component_car_list_item_component, {\n      key: key,\n      id: key,\n      title: car.car.title,\n      description: car.car.description,\n      image: car.car.image,\n      owner_id: car.car.owner_id,\n      price_per_hour: car.car.price_per_hour,\n      is_rent: \"true\",\n      stream_id: car.rent.id\n    }, null, 8\n    /* PROPS */\n    , [\"id\", \"title\", \"description\", \"image\", \"owner_id\", \"price_per_hour\", \"stream_id\"]);\n  }), 128\n  /* KEYED_FRAGMENT */\n  ))])])]);\n}","map":{"version":3,"mappings":";;EACWA,KAAK,EAAC;;;EACRA,KAAK,EAAC;;;EAEJA,KAAK,EAAC;;;;;uBAHfC,oBAmBU,SAnBV,cAmBU,CAlBRC,oBAiBM,KAjBN,cAiBM,CAfJA,oBAcM,KAdN,cAcM,oBAbJD,oBAW0BE,SAX1B,EAW0B,IAX1B,EAW0BC,YAXmBC,UAWnB,EAXuB,CAAhBC,GAAgB,EAAZC,GAAY,KAAT;yBAAxCC,aAW0BC,kCAX1B,EAW0B;MAX0BF,GAAG,EAAEA,GAW/B;MAVAG,EAAE,EAAEH,GAUJ;MATAI,KAAK,EAAEL,GAAG,CAACA,GAAJ,CAAQK,KASf;MARAC,WAAW,EAAEN,GAAG,CAACA,GAAJ,CAAQM,WAQrB;MAPAC,KAAK,EAAEP,GAAG,CAACA,GAAJ,CAAQO,KAOf;MANAC,QAAQ,EAAER,GAAG,CAACA,GAAJ,CAAQQ,QAMlB;MALAC,cAAc,EAAET,GAAG,CAACA,GAAJ,CAAQS,cAKxB;MAJDC,OAAO,EAAC,MAIP;MAHAC,SAAS,EAAEX,GAAG,CAACY,IAAJ,CAASR;IAGpB,CAX1B;;IAAA;GAW0B,CAX1B;;EAAA,CAaI,EAdN,CAeI,CAjBN,CAkBQ,CAnBV","names":["class","_createElementBlock","_createElementVNode","_Fragment","_renderList","$data","car","key","_createBlock","_component_car_list_item_component","id","title","description","image","owner_id","price_per_hour","is_rent","stream_id","rent"],"sourceRoot":"","sources":["/var/www/ch-8-car-renting/frontend/src/components/Pages/MyRentsComponent.vue"],"sourcesContent":["<template>\n  <section class=\"site-section p-4\">\n    <div class=\"container\">\n\n      <div class=\"row\">\n        <car-list-item-component v-for=\"(car,key) in cars\" :key=\"key\"\n                                 :id=\"key\"\n                                 :title=\"car.car.title\"\n                                 :description=\"car.car.description\"\n                                 :image=\"car.car.image\"\n                                 :owner_id=\"car.car.owner_id\"\n                                 :price_per_hour=\"car.car.price_per_hour\"\n                                 is_rent=\"true\"\n                                 :stream_id=\"car.rent.id\"\n        >\n\n        </car-list-item-component>\n\n      </div>\n    </div>\n  </section>\n</template>\n\n<script>\nimport CarListItemComponent from \"@/components/Pages/CarListItemComponent\";\nimport * as nearAPI from \"near-api-js\";\nimport {getTransactionState, getUrlParams} from \"../../../helpers\";\nimport Big from \"big.js\";\n\nexport default {\n  name: \"MyRentsComponent\",\n  components:{\n    CarListItemComponent\n  },\n  data(){\n    return {\n      cars : {}\n    }\n  },\n  methods:{\n    async getStream(stream_id){\n      console.log(stream_id)\n      const provider = new nearAPI.providers.JsonRpcProvider(window.nearConfig.nodeUrl);\n      const argsBase64 = window.btoa(JSON.stringify({\"stream_id\":stream_id}))\n      const rawResult = await provider.query({\n        request_type: \"call_function\",\n        finality: \"final\",\n        account_id: window.roketoContractName,\n        method_name: \"get_stream\",\n        args_base64: argsBase64,\n      });\n      return JSON.parse(Buffer.from(rawResult.result).toString())\n    },\n    async getMyCars(){\n      const provider = new nearAPI.providers.JsonRpcProvider(window.nearConfig.nodeUrl);\n      const argsBase64 = window.btoa(JSON.stringify({renter_account_id:window.nearAccount.accountId}))\n      const rawResult = await provider.query({\n        request_type: \"call_function\",\n        finality: \"final\",\n        account_id: window.nearConfig.contractName,\n        method_name: \"get_rents_by_renter_id\",\n        args_base64: argsBase64,\n      });\n      let cars = JSON.parse(Buffer.from(rawResult.result).toString())\n      console.log(cars)\n      let result = [];\n      for (const [key, value] of Object.entries(cars)) {\n        result.push({\n          car:value.car,\n          rent: await this.getStream(value.rent.stream_id)\n        })\n      }\n      this.cars = result;\n      console.log(result)\n    },\n\n\n  },\n  async mounted() {\n    let loader = this.$loading.show();\n    await this.getMyCars()\n    loader.hide()\n  },\n\n}\n</script>\n\n<style scoped>\n\n</style>"]},"metadata":{},"sourceType":"module"}