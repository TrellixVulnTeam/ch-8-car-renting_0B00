{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { CarWriter } from '@ipld/car';\nexport class TreewalkCarJoiner {\n  constructor(cars) {\n    this._cars = Array.from(cars);\n    if (!this._cars.length) throw new Error('missing CARs');\n  }\n\n  async *car() {\n    const reader = this._cars[0];\n    const roots = await reader.getRoots();\n    const {\n      writer,\n      out\n    } = CarWriter.create(roots);\n\n    const writeCar = async () => {\n      const written = new Set();\n\n      const writeBlocks = async reader => {\n        for await (const b of reader.blocks()) {\n          if (written.has(b.cid.toString())) continue;\n          await writer.put(b);\n          written.add(b.cid.toString());\n        }\n      };\n\n      try {\n        await writeBlocks(reader);\n\n        for (const reader of this._cars.slice(1)) {\n          await writeBlocks(reader);\n        }\n      } catch (err) {\n        console.error(err);\n      } finally {\n        await writer.close();\n      }\n    };\n\n    writeCar();\n    yield* out;\n  }\n\n}","map":{"version":3,"names":["CarWriter","TreewalkCarJoiner","constructor","cars","_cars","Array","from","length","Error","car","reader","roots","getRoots","writer","out","create","writeCar","written","Set","writeBlocks","b","blocks","has","cid","toString","put","add","slice","err","console","error","close"],"sources":["/var/www/ch-8-car-renting/frontend/node_modules/carbites/esm/lib/treewalk/joiner.js"],"sourcesContent":["import { CarWriter } from '@ipld/car';\nexport class TreewalkCarJoiner {\n  constructor(cars) {\n    this._cars = Array.from(cars);\n    if (!this._cars.length)\n      throw new Error('missing CARs');\n  }\n  async *car() {\n    const reader = this._cars[0];\n    const roots = await reader.getRoots();\n    const {writer, out} = CarWriter.create(roots);\n    const writeCar = async () => {\n      const written = new Set();\n      const writeBlocks = async reader => {\n        for await (const b of reader.blocks()) {\n          if (written.has(b.cid.toString()))\n            continue;\n          await writer.put(b);\n          written.add(b.cid.toString());\n        }\n      };\n      try {\n        await writeBlocks(reader);\n        for (const reader of this._cars.slice(1)) {\n          await writeBlocks(reader);\n        }\n      } catch (err) {\n        console.error(err);\n      } finally {\n        await writer.close();\n      }\n    };\n    writeCar();\n    yield* out;\n  }\n}"],"mappings":";AAAA,SAASA,SAAT,QAA0B,WAA1B;AACA,OAAO,MAAMC,iBAAN,CAAwB;EAC7BC,WAAW,CAACC,IAAD,EAAO;IAChB,KAAKC,KAAL,GAAaC,KAAK,CAACC,IAAN,CAAWH,IAAX,CAAb;IACA,IAAI,CAAC,KAAKC,KAAL,CAAWG,MAAhB,EACE,MAAM,IAAIC,KAAJ,CAAU,cAAV,CAAN;EACH;;EACS,OAAHC,GAAG,GAAG;IACX,MAAMC,MAAM,GAAG,KAAKN,KAAL,CAAW,CAAX,CAAf;IACA,MAAMO,KAAK,GAAG,MAAMD,MAAM,CAACE,QAAP,EAApB;IACA,MAAM;MAACC,MAAD;MAASC;IAAT,IAAgBd,SAAS,CAACe,MAAV,CAAiBJ,KAAjB,CAAtB;;IACA,MAAMK,QAAQ,GAAG,YAAY;MAC3B,MAAMC,OAAO,GAAG,IAAIC,GAAJ,EAAhB;;MACA,MAAMC,WAAW,GAAG,MAAMT,MAAN,IAAgB;QAClC,WAAW,MAAMU,CAAjB,IAAsBV,MAAM,CAACW,MAAP,EAAtB,EAAuC;UACrC,IAAIJ,OAAO,CAACK,GAAR,CAAYF,CAAC,CAACG,GAAF,CAAMC,QAAN,EAAZ,CAAJ,EACE;UACF,MAAMX,MAAM,CAACY,GAAP,CAAWL,CAAX,CAAN;UACAH,OAAO,CAACS,GAAR,CAAYN,CAAC,CAACG,GAAF,CAAMC,QAAN,EAAZ;QACD;MACF,CAPD;;MAQA,IAAI;QACF,MAAML,WAAW,CAACT,MAAD,CAAjB;;QACA,KAAK,MAAMA,MAAX,IAAqB,KAAKN,KAAL,CAAWuB,KAAX,CAAiB,CAAjB,CAArB,EAA0C;UACxC,MAAMR,WAAW,CAACT,MAAD,CAAjB;QACD;MACF,CALD,CAKE,OAAOkB,GAAP,EAAY;QACZC,OAAO,CAACC,KAAR,CAAcF,GAAd;MACD,CAPD,SAOU;QACR,MAAMf,MAAM,CAACkB,KAAP,EAAN;MACD;IACF,CApBD;;IAqBAf,QAAQ;IACR,OAAOF,GAAP;EACD;;AAjC4B"},"metadata":{},"sourceType":"module"}