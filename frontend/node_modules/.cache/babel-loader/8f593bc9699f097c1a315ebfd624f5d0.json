{"ast":null,"code":"import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, withModifiers as _withModifiers, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"site-section\"\n};\nconst _hoisted_2 = {\n  class: \"container\"\n};\nconst _hoisted_3 = {\n  class: \"row mb-5 align-items-st\"\n};\nconst _hoisted_4 = {\n  class: \"col-md-5\"\n};\nconst _hoisted_5 = {\n  class: \"heading-20219\"\n};\nconst _hoisted_6 = {\n  class: \"title text-cursive mb-4\"\n};\nconst _hoisted_7 = [\"disabled\"];\nconst _hoisted_8 = {\n  class: \"col-md-7\"\n};\nconst _hoisted_9 = {\n  class: \"cause shadow-sm\"\n};\nconst _hoisted_10 = {\n  class: \"cause-link d-block\"\n};\nconst _hoisted_11 = [\"src\"];\nconst _hoisted_12 = {\n  class: \"px-3 pt-3 border-top-0 border border shadow-sm\"\n};\nconst _hoisted_13 = {\n  class: \"mb-4\"\n};\nconst _hoisted_14 = {\n  class: \"border-top border-light border-bottom py-2 d-flex justify-content-between\"\n};\n\nconst _hoisted_15 = /*#__PURE__*/_createElementVNode(\"div\", null, \"Ticket price\", -1\n/* HOISTED */\n);\n\nconst _hoisted_16 = {\n  class: \"ml-auto\"\n};\nconst _hoisted_17 = {\n  class: \"text-success\"\n};\nconst _hoisted_18 = {\n  class: \"py-4\"\n};\nconst _hoisted_19 = {\n  class: \"d-flex align-items-center\"\n};\nconst _hoisted_20 = {\n  class: \"\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_custom_progress_bar = _resolveComponent(\"custom-progress-bar\");\n\n  const _component_font_awesome_icon = _resolveComponent(\"font-awesome-icon\");\n\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"h2\", _hoisted_6, _toDisplayString($data.currentMeeting.title), 1\n  /* TEXT */\n  ), _createElementVNode(\"p\", null, _toDisplayString($data.currentMeeting.description), 1\n  /* TEXT */\n  ), _createElementVNode(\"p\", null, [_createElementVNode(\"button\", {\n    class: \"btn btn-primary rounded-0 px-4\",\n    onClick: _cache[0] || (_cache[0] = _withModifiers((...args) => $options.buyTicketAction && $options.buyTicketAction(...args), [\"prevent\"])),\n    disabled: $data.currentMeeting.bought_tickets == $data.currentMeeting.total_tickets\n  }, \"Buy Ticket\", 8\n  /* PROPS */\n  , _hoisted_7)])])]), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"a\", _hoisted_10, [_createElementVNode(\"img\", {\n    src: $data.currentMeeting.nft_media,\n    alt: \"Image\",\n    class: \"img-fluid\"\n  }, null, 8\n  /* PROPS */\n  , _hoisted_11), _createVNode(_component_custom_progress_bar, {\n    \"current-value\": $data.currentMeeting.bought_tickets,\n    \"max-value\": $data.currentMeeting.total_tickets\n  }, null, 8\n  /* PROPS */\n  , [\"current-value\", \"max-value\"])]), _createElementVNode(\"div\", _hoisted_12, [_createElementVNode(\"span\", {\n    class: _normalizeClass([\"py-1 small px-2 rounded mb-3 d-inline-block\", $data.currentDonationTypeClassName])\n  }, [_createVNode(_component_font_awesome_icon, {\n    icon: $data.currentDonationTypeIconName\n  }, null, 8\n  /* PROPS */\n  , [\"icon\"]), _createTextVNode(\" \" + _toDisplayString($data.currentMeeting.donation_type), 1\n  /* TEXT */\n  )], 2\n  /* CLASS */\n  ), _createElementVNode(\"h3\", _hoisted_13, _toDisplayString($data.currentMeeting.title), 1\n  /* TEXT */\n  ), _createElementVNode(\"div\", _hoisted_14, [_hoisted_15, _createElementVNode(\"div\", _hoisted_16, [_createElementVNode(\"strong\", _hoisted_17, _toDisplayString(_ctx.$filters.formatTicketPrice($data.currentMeeting.ticket_price)) + \" Ⓝ\", 1\n  /* TEXT */\n  )])]), _createElementVNode(\"div\", _hoisted_18, [_createElementVNode(\"div\", _hoisted_19, [_createElementVNode(\"div\", _hoisted_20, _toDisplayString($data.currentMeeting.owner_name), 1\n  /* TEXT */\n  )])])])])])])])]);\n}","map":{"version":3,"mappings":";;EACOA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;EAEJA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;EACLA,KAAK,EAAC;;;;EAKTA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;EAENA,KAAK,EAAC;;;;EAKJA,KAAK,EAAC;;;EAGLA,KAAK,EAAC;;;EACLA,KAAK,EAAC;;;iCACTC,oBAAuB,KAAvB,EAAuB,IAAvB,EAAK,cAAL,EAAiB;AAAA;AAAjB;;;EACKD,KAAK,EAAC;;;EAAkBA,KAAK,EAAC;;;EAGhCA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;;;;;uBA9B3BE,oBAuCM,KAvCN,cAuCM,CAtCJD,oBAqCM,KArCN,cAqCM,CAnCJA,oBAkCM,KAlCN,cAkCM,CAjCJA,oBAMM,KANN,cAMM,CALJA,oBAIM,KAJN,cAIM,CAHJA,oBAAmE,IAAnE,cAAmEE,iBAA5BC,qBAAeC,KAAa,CAAnE,EAA2D;EAAA;EAA3D,CAGI,EAFJJ,oBAAqC,GAArC,EAAqC,IAArC,EAAqCE,iBAAhCC,qBAAeE,WAAiB,CAArC,EAA+B;EAAA;EAA/B,CAEI,EADJL,oBAAoL,GAApL,EAAoL,IAApL,EAAoL,CAAjLA,oBAA6K,QAA7K,EAA6K;IAArKD,KAAK,EAAC,gCAA+J;IAA7HO,OAAK,wDAAUC,6DAAV,EAAyB,WAAzB,EAAwH;IAA5FC,QAAQ,EAAEL,qBAAeM,cAAf,IAAiCN,qBAAeO;EAAkC,CAA7K,EAA0J,YAA1J,EAAoK;EAAA;EAApK,EAAoKC,UAApK,CAAiL,CAApL,CACI,CAJN,CAKI,CANN,CAiCI,EA1BJX,oBAyBM,KAzBN,cAyBM,CAxBJA,oBAuBM,KAvBN,cAuBM,CArBJA,oBAGI,GAHJ,eAGI,CAFFA,oBAAmE,KAAnE,EAAmE;IAA7DY,GAAG,EAAET,qBAAeU,SAAyC;IAA9BC,GAAG,EAAC,OAA0B;IAAlBf,KAAK,EAAC;EAAY,CAAnE;;EAAA,cAEE,EADFgB,aAAoIC,8BAApI,EAAoI;IAA9G,iBAAeb,qBAAeM,cAAgF;IAA/D,aAAWN,qBAAeO;EAAqC,CAApI;;EAAA,iCACE,CAHJ,CAqBI,EAhBJV,oBAcM,KAdN,eAcM,CAbJA,oBACqG,MADrG,EACqG;IAD/FD,KAAK,mBAAC,6CAAD,EAAuDI,kCAAvD;EAC0F,CADrG,GACEY,aAAyDE,4BAAzD,EAAyD;IAArCC,IAAI,EAAEf;EAA+B,CAAzD,EAAqD,IAArD,EAAqD;EAAA;EAArD,EAAqD,QAArD,oBAAyD,MAACD,iBAAGC,qBAAegB,aAAlB,GAA+B;EAAA;IAD3F;;EAAA,CAaI,EAXJnB,oBAAgD,IAAhD,eAAgDE,iBAA5BC,qBAAeC,KAAa,CAAhD,EAAwC;EAAA;EAAxC,CAWI,EAVJJ,oBAGM,KAHN,eAGM,CAFJoB,WAEI,EADJpB,oBAAgI,KAAhI,eAAgI,CAA3GA,oBAAqG,QAArG,eAAqGE,iBAArEmB,cAASC,iBAAT,CAA2BnB,qBAAeoB,YAA1C,CAAqE,IAAX,IAA1F,EAA4F;EAAA;EAA5F,CAA2G,CAAhI,CACI,CAHN,CAUI,EALJvB,oBAIM,KAJN,eAIM,CAHJA,oBAEM,KAFN,eAEM,CADJA,oBAAmD,KAAnD,eAAmDE,iBAAlCC,qBAAeqB,UAAmB,CAAnD,EAA0C;EAAA;EAA1C,CACI,CAFN,CAGI,CAJN,CAKI,CAdN,CAgBI,CAvBN,CAwBI,CAzBN,CA0BI,CAlCN,CAmCI,CArCN,CAsCI,CAvCN","names":["class","_createElementVNode","_createElementBlock","_toDisplayString","$data","title","description","onClick","$options","disabled","bought_tickets","total_tickets","_hoisted_7","src","nft_media","alt","_createVNode","_component_custom_progress_bar","_component_font_awesome_icon","icon","donation_type","_hoisted_15","_ctx","formatTicketPrice","ticket_price","owner_name"],"sourceRoot":"","sources":["/var/www/ch-8-car-renting/frontend/src/components/Pages/SingleMeetingComponent.vue"],"sourcesContent":["<template>\n  <div class=\"site-section\">\n    <div class=\"container\">\n\n      <div class=\"row mb-5 align-items-st\">\n        <div class=\"col-md-5\">\n          <div class=\"heading-20219\">\n            <h2 class=\"title text-cursive mb-4\">{{ currentMeeting.title }}</h2>\n            <p>{{currentMeeting.description}}</p>\n            <p><button class=\"btn btn-primary rounded-0 px-4\" @click.prevent=\"buyTicketAction\" :disabled=\"currentMeeting.bought_tickets == currentMeeting.total_tickets\">Buy Ticket</button></p>\n          </div>\n        </div>\n        <div class=\"col-md-7\">\n          <div class=\"cause shadow-sm\">\n\n            <a class=\"cause-link d-block\">\n              <img :src=\"currentMeeting.nft_media\" alt=\"Image\" class=\"img-fluid\">\n              <custom-progress-bar :current-value=\"currentMeeting.bought_tickets\" :max-value=\"currentMeeting.total_tickets\"></custom-progress-bar>\n            </a>\n\n            <div class=\"px-3 pt-3 border-top-0 border border shadow-sm\">\n              <span class=\"py-1 small px-2 rounded mb-3 d-inline-block\" :class=\"currentDonationTypeClassName\">\n                <font-awesome-icon :icon=\"currentDonationTypeIconName\" /> {{ currentMeeting.donation_type }}</span>\n              <h3 class=\"mb-4\">{{ currentMeeting.title }}</h3>\n              <div class=\"border-top border-light border-bottom py-2 d-flex justify-content-between\">\n                <div>Ticket price</div>\n                <div class=\"ml-auto\"><strong class=\"text-success\">{{ $filters.formatTicketPrice(currentMeeting.ticket_price) }} Ⓝ</strong></div>\n              </div>\n\n              <div class=\"py-4\">\n                <div class=\"d-flex align-items-center\">\n                  <div class=\"\">{{ currentMeeting.owner_name }}</div>\n                </div>\n              </div>\n            </div>\n\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n\n</template>\n\n<script>\nimport CustomProgressBar from \"@/components/Items/CustomProgressBar\";\nimport Big from \"big.js\";\nconst BOATLOAD_OF_GAS = Big(3).times(10 ** 13).toFixed();\n\nexport default {\n  name: \"SingleMeetingComponent\",\n  components: {\n    CustomProgressBar,\n  },\n  data(){\n    return {\n      currentMeeting:{},\n      currentDonationTypeClassName:'',\n      currentDonationTypeIconName:'',\n    }\n  },\n  methods:{\n    async getCurrentMeeting(){\n      const argsBase64 = window.btoa(JSON.stringify({id:+this.$route.params.id}))\n      let result = await window.provider.query({\n        request_type: \"call_function\",\n        account_id: window.walletSelector.getContractId(),\n        method_name: \"get_meeting_by_id\",\n        args_base64: argsBase64,\n        finality: \"optimistic\",\n      }).catch(()=>{\n        this.$router.push({'name':'home'});\n      })\n      this.currentMeeting = JSON.parse(Buffer.from(result.result).toString())\n    },\n\n    async buyTicket() {\n      await window.walletSelector.signAndSendTransaction({\n        signerId: window.nearAccount.accountId,\n        // receiverId: nearConfig.contractName,\n        actions:[\n          {\n            type: \"FunctionCall\",\n            params: {\n              methodName: \"buy_ticket\",\n              args: {\n                \"meeting_id\": +this.$route.params.id,\n              },\n              gas: BOATLOAD_OF_GAS,\n              deposit: Big((this.currentMeeting.ticket_price / (10**24)).toFixed(5)).times(10 ** 24).toFixed()\n            },\n          },\n        ]\n      });\n    },\n\n    async buyTicketAction(){\n      let loader = this.$loading.show();\n      try {\n        await this.buyTicket();\n        this.$swal.fire({\n          icon: 'success',\n          title: 'Success',\n          text: 'Ticket was successfully bought!',\n          footer: `To look at your ticket go to your wallet collectibles!`,\n        })\n        await this.getCurrentMeeting();\n      }catch (error){\n        this.$swal.fire({\n          icon: 'error',\n          title: 'Error',\n          text: error.message,\n          footer: ``,\n        })\n        console.log(error)\n      }\n      loader.hide();\n\n    }\n  },\n  async mounted() {\n    let loader = this.$loading.show();\n    await this.getCurrentMeeting();\n    this.currentDonationTypeClassName =this.$DONATION_TYPES[this.currentMeeting.donation_type].className;\n    this.currentDonationTypeIconName =  this.$DONATION_TYPES[this.currentMeeting.donation_type].iconName;\n    loader.hide();\n\n    let uri = window.location.search.substring(1);\n    let params = new URLSearchParams(uri);\n    const transactionHash = params.get('transactionHashes');\n    if(transactionHash){\n      this.$swal.fire({\n        icon: 'success',\n        title: 'Success',\n        text: 'Ticket was successfully bought!',\n        footer: `To look at your ticket go to your wallet collectibles!`,\n      })\n    }\n  },\n}\n</script>\n\n<style scoped>\n\n</style>"]},"metadata":{},"sourceType":"module"}