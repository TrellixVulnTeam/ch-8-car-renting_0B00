{"ast":null,"code":"import { getTransactionState, getUrlParams } from \"../../../helpers\";\nimport Big from \"big.js\";\nexport default {\n  name: \"CarListItemComponent\",\n  props: ['id', 'title', 'description', 'image', 'owner_id', 'price_per_hour', 'is_rent', 'stream_id'],\n  methods: {\n    async continueCancelRentCarProcess() {\n      let params = getUrlParams();\n      let transactionHashes = params.get('transactionHashes');\n\n      if (transactionHashes !== null) {\n        let result = await getTransactionState(transactionHashes);\n\n        if (\"SuccessValue\" in result.status) {\n          const transactionMethodName = result.transaction.actions[0].FunctionCall.method_name;\n\n          switch (transactionMethodName) {\n            case 'near_deposit':\n              await this.afterNearDeposit();\n              this.cleanGetParams();\n              break;\n\n            case 'ft_transfer_call':\n              await this.afterFtTransferCall();\n              this.cleanGetParams();\n              break;\n\n            case 'get_account_outgoing_streams':\n              this.$swal.fire({\n                icon: 'success',\n                title: 'Success',\n                text: 'Car was rent!',\n                footer: ``\n              });\n              this.cleanGetParams();\n              break;\n          }\n        }\n      }\n    },\n\n    async startCancelRentCarProcess() {\n      let loader = this.$loading.show();\n      window.walletConnection.account().functionCall({\n        contractId: window.roketoContractName,\n        methodName: 'stop_stream',\n        args: {\n          \"stream_id\": this.stream_id\n        },\n        gas: \"200000000000000\"\n      }).then(response => {\n        console.log(response);\n      });\n      loader.hide();\n    }\n\n  },\n\n  async mounted() {\n    let loader = this.$loading.show();\n    await this.continueCancelRentCarProcess();\n    loader.hide();\n  }\n\n};","map":{"version":3,"mappings":"AA4BA,SAAQA,mBAAR,EAA6BC,YAA7B,QAAgD,kBAAhD;AACA,OAAOC,GAAP,MAAgB,QAAhB;AAEA,eAAe;EACbC,IAAI,EAAE,sBADO;EAEbC,KAAK,EAAE,CACL,IADK,EAEL,OAFK,EAGL,aAHK,EAIL,OAJK,EAKL,UALK,EAML,gBANK,EAOL,SAPK,EAQL,WARK,CAFM;EAYbC,OAAO,EAAC;IACN,MAAMC,4BAAN,GAAqC;MACnC,IAAIC,MAAK,GAAIN,YAAY,EAAzB;MACA,IAAIO,iBAAgB,GAAID,MAAM,CAACE,GAAP,CAAW,mBAAX,CAAxB;;MACA,IAAID,iBAAgB,KAAM,IAA1B,EAA+B;QAC7B,IAAIE,MAAK,GAAI,MAAMV,mBAAmB,CAACQ,iBAAD,CAAtC;;QACA,IAAI,kBAAkBE,MAAM,CAACC,MAA7B,EAAoC;UAClC,MAAMC,qBAAoB,GAAIF,MAAM,CAACG,WAAP,CAAmBC,OAAnB,CAA2B,CAA3B,EAA8BC,YAA9B,CAA2CC,WAAzE;;UACA,QAAQJ,qBAAR;YACE,KAAK,cAAL;cACE,MAAM,KAAKK,gBAAL,EAAN;cACA,KAAKC,cAAL;cACA;;YACF,KAAK,kBAAL;cACE,MAAM,KAAKC,mBAAL,EAAN;cACA,KAAKD,cAAL;cACA;;YACF,KAAK,8BAAL;cACE,KAAKE,KAAL,CAAWC,IAAX,CAAgB;gBACdC,IAAI,EAAE,SADQ;gBAEdC,KAAK,EAAE,SAFO;gBAGdC,IAAI,EAAE,eAHQ;gBAIdC,MAAM,EAAG;cAJK,CAAhB;cAMA,KAAKP,cAAL;cACA;UAjBJ;QAmBF;MACF;IACD,CA7BK;;IA8BN,MAAMQ,yBAAN,GAAiC;MAC/B,IAAIC,MAAK,GAAI,KAAKC,QAAL,CAAcC,IAAd,EAAb;MACAC,MAAM,CAACC,gBAAP,CAAwBC,OAAxB,GAAkCC,YAAlC,CAA+C;QAC7CC,UAAU,EAAEJ,MAAM,CAACK,kBAD0B;QAE7CC,UAAU,EAAE,aAFiC;QAG7CC,IAAI,EAAE;UAAC,aAAa,KAAKC;QAAnB,CAHuC;QAI7CC,GAAG,EAAC;MAJyC,CAA/C,EAKGC,IALH,CAKSC,QAAD,IAAY;QAClBC,OAAO,CAACC,GAAR,CAAYF,QAAZ;MACD,CAPD;MAQAd,MAAM,CAACiB,IAAP;IACD;;EAzCK,CAZK;;EAuDb,MAAMC,OAAN,GAAgB;IACd,IAAIlB,MAAK,GAAI,KAAKC,QAAL,CAAcC,IAAd,EAAb;IACA,MAAM,KAAKvB,4BAAL,EAAN;IACAqB,MAAM,CAACiB,IAAP;EACF;;AA3Da,CAAf","names":["getTransactionState","getUrlParams","Big","name","props","methods","continueCancelRentCarProcess","params","transactionHashes","get","result","status","transactionMethodName","transaction","actions","FunctionCall","method_name","afterNearDeposit","cleanGetParams","afterFtTransferCall","$swal","fire","icon","title","text","footer","startCancelRentCarProcess","loader","$loading","show","window","walletConnection","account","functionCall","contractId","roketoContractName","methodName","args","stream_id","gas","then","response","console","log","hide","mounted"],"sourceRoot":"","sources":["/var/www/ch-8-car-renting/frontend/src/components/Pages/CarListItemComponent.vue"],"sourcesContent":["<template>\n  <div class=\"col-4 mb-4\">\n    <div class=\"card\">\n      <img :src=\"image\" class=\"card-img-top\" alt=\"...\" style=\"height: 250px\">\n      <div class=\"card-body\">\n        <h5 class=\"card-title\">{{ title }}</h5>\n        <p class=\"card-text\">{{description}}</p>\n      </div>\n      <ul class=\"list-group list-group-flush\">\n        <li class=\"list-group-item d-flex justify-content-between\"><span>Owner:</span><span>{{owner_id}}</span></li>\n        <li class=\"list-group-item d-flex justify-content-between\"><span>Price per hour:</span><span>{{$filters.formatYoctoNearToNear(price_per_hour)}} Ⓝ</span></li>\n      </ul>\n      <router-link :to=\"{name:'car-single',params:{id:id}}\" class=\"btn btn-primary\">Go to car page</router-link>\n      <div v-if=\"is_rent\">\n        <hr>\n        <ul class=\"list-group list-group-flush\">\n          <li class=\"list-group-item d-flex justify-content-between\"><span>Owner:</span><span>{{owner_id}}</span></li>\n          <li class=\"list-group-item d-flex justify-content-between\"><span>Price per hour:</span><span>{{$filters.formatYoctoNearToNear(price_per_hour)}} Ⓝ</span></li>\n        </ul>\n        <button class=\"btn btn-danger w-100\" @click.prevent=\"startCancelRentCarProcess\">Cancel renting</button>\n      </div>\n\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport {getTransactionState, getUrlParams} from \"../../../helpers\";\nimport Big from \"big.js\";\n\nexport default {\n  name: \"CarListItemComponent\",\n  props: [\n    'id',\n    'title',\n    'description',\n    'image',\n    'owner_id',\n    'price_per_hour',\n    'is_rent',\n    'stream_id',\n  ],\n  methods:{\n    async continueCancelRentCarProcess() {\n      let params = getUrlParams();\n      let transactionHashes = params.get('transactionHashes');\n      if (transactionHashes !== null){\n        let result = await getTransactionState(transactionHashes);\n        if (\"SuccessValue\" in result.status){\n          const transactionMethodName = result.transaction.actions[0].FunctionCall.method_name;\n          switch (transactionMethodName){\n            case 'near_deposit':\n              await this.afterNearDeposit();\n              this.cleanGetParams();\n              break;\n            case 'ft_transfer_call':\n              await this.afterFtTransferCall();\n              this.cleanGetParams();\n              break;\n            case 'get_account_outgoing_streams':\n              this.$swal.fire({\n                icon: 'success',\n                title: 'Success',\n                text: 'Car was rent!',\n                footer: ``,\n              })\n              this.cleanGetParams();\n              break;\n          }\n        }\n      }\n    },\n    async startCancelRentCarProcess(){\n      let loader = this.$loading.show();\n      window.walletConnection.account().functionCall({\n        contractId: window.roketoContractName,\n        methodName: 'stop_stream',\n        args: {\"stream_id\": this.stream_id},\n        gas:\"200000000000000\",\n      }).then((response)=>{\n        console.log(response)\n      });\n      loader.hide();\n    },\n  },\n  async mounted() {\n    let loader = this.$loading.show();\n    await this.continueCancelRentCarProcess()\n    loader.hide()\n  }\n\n}\n</script>\n\n<style scoped>\n\n</style>"]},"metadata":{},"sourceType":"module"}